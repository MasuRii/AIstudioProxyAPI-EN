# AI Studio Proxy API Configuration Template
# 复制此文件为 .env 并根据需要修改配置
# Copy this file to .env and modify as needed

# =============================================================================
# 1. 服务端口配置 (Server Port Configuration)
# =============================================================================

# FastAPI 主服务端口 (Main API Port)
# The port where the main OpenAI-compatible API will listen.
PORT=2048

# GUI 启动器默认端口配置 (Launcher Defaults)
# 这些值仅用于启动器显示的默认建议，实际运行端口由上面的 PORT 决定。
DEFAULT_FASTAPI_PORT=2048
DEFAULT_CAMOUFOX_PORT=9222

# =============================================================================
# 2. 认证配置 (Authentication Configuration)
# =============================================================================

# 自动保存认证信息 (Auto Save Auth)
# 设置为 true 以在成功登录后自动保存认证状态 (cookies/localStorage)。
# [IMPORTANT] Must be true in debug mode to save new authentication profiles.
AUTO_SAVE_AUTH=false

# 认证保存超时时间 (Auth Save Timeout - seconds)
# 在 debug 模式下等待用户输入保存文件名的超时时间。
AUTH_SAVE_TIMEOUT=30

# 自动轮换认证配置文件 (Auto Rotate Auth Profile)
# When enabled, the system will automatically rotate authentication profiles
# when quota is exceeded or other auth-related issues occur.
AUTO_ROTATE_AUTH_PROFILE=true

# 启动时自动轮换 (Auto Auth Rotation on Startup)
# When enabled, the system will automatically select an available auth profile on startup.
AUTO_AUTH_ROTATION_ON_STARTUP=false

# 自动确认登录 (Auto Confirm Login)
AUTO_CONFIRM_LOGIN=true

# 配额轮换阈值 (Quota Rotation Thresholds)
# Soft Limit: Triggers "Rotation Pending" flag. Current stream finishes, then rotates.
QUOTA_SOFT_LIMIT=450000
# Hard Limit: Triggers immediate "Kill Signal" to prevent hard bans.
QUOTA_HARD_LIMIT=550000

# =============================================================================
# 3. 浏览与启动配置 (Browser & Model Configuration)
# =============================================================================

# 启动模式 (Launch Mode)
# Options: normal, debug, headless, virtual_display, direct_debug_no_browser
LAUNCH_MODE=normal

# Camoufox WebSocket 端点 (Camoufox WebSocket Endpoint)
# For connecting to existing external Camoufox/Chrome instance.
# CAMOUFOX_WS_ENDPOINT=ws://127.0.0.1:9222

# 快速启动 (Direct Launch)
# Skip launcher menu and use .env config directly.
DIRECT_LAUNCH=false

# 仅收集当前用户消息中的附件 (Only Collect Current User Attachments)
ONLY_COLLECT_CURRENT_USER_ATTACHMENTS=false

# =============================================================================
# 4. 代理配置 (Proxy Configuration)
# =============================================================================

# 统一代理配置 (Unified Proxy)
# Recommended. Configures HTTP_PROXY, HTTPS_PROXY and internal browser proxy.
UNIFIED_PROXY_CONFIG=http://127.0.0.1:7890

# 传统代理设置 (Legacy Proxy Settings)
# Only effective if UNIFIED_PROXY_CONFIG is not set.
# HTTP_PROXY=http://127.0.0.1:7890
# HTTPS_PROXY=http://127.0.0.1:7890

# 代理绕过列表 (No Proxy)
# NO_PROXY=localhost,127.0.0.1,::1

# =============================================================================
# 5. 日志与调试 (Logging & Debugging)
# =============================================================================

# 服务器日志级别 (Log Level)
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
SERVER_LOG_LEVEL=INFO

# 打印重定向 (Redirect Print)
# Redirect all print output to log file.
SERVER_REDIRECT_PRINT=false

# 扩展日志开关 (Extended Logs)
DEBUG_LOGS_ENABLED=false
TRACE_LOGS_ENABLED=false

# JSON 结构化日志 (Structured JSON Logging)
JSON_LOGS=false

# 日志文件轮换配置 (Log Rotation Configuration)
LOG_FILE_MAX_BYTES=10485760
LOG_FILE_BACKUP_COUNT=5

# =============================================================================
# 6. API 默认参数 (API Defaults)
# =============================================================================

# 默认采样参数 (Default Sampling)
DEFAULT_TEMPERATURE=1.0
DEFAULT_MAX_OUTPUT_TOKENS=65536
DEFAULT_TOP_P=0.95
DEFAULT_STOP_SEQUENCES=["User:"]

# 思考模型配置 (Thinking Models)
# 适用于 gemini-2.0-flash-thinking 等模型
ENABLE_THINKING_BUDGET=false
DEFAULT_THINKING_BUDGET=8192

# Gemini 3 默认思考等级
DEFAULT_THINKING_LEVEL_PRO=high
DEFAULT_THINKING_LEVEL_FLASH=high

# 工具配置 (Tools)
ENABLE_GOOGLE_SEARCH=false
ENABLE_URL_CONTEXT=false

# =============================================================================
# 7. 高级超时配置 (Advanced Timeouts)
# =============================================================================
# 单位均为毫秒 (ms)，除非另有说明 (All values in milliseconds unless specified)

# 响应总超时 (Response Completion Total Timeout)
# Default: 600000 (10 minutes)
RESPONSE_COMPLETION_TIMEOUT=600000

# 轮询间隔 (Polling Interval)
POLLING_INTERVAL=300
POLLING_INTERVAL_STREAM=180

# 静默超时 (Silence Timeout)
# max(SILENCE_TIMEOUT_MS/1000, dynamic_timeout/2.0)
SILENCE_TIMEOUT_MS=60000

# 页面交互超时 (Interaction Timeouts)
CLICK_TIMEOUT_MS=3000
WAIT_FOR_ELEMENT_TIMEOUT_MS=10000

# =============================================================================
# 8. 其他系统配置 (Misc System Config)
# =============================================================================

# 流式代理服务端口 (Stream Proxy Port)
# Set to 0 to disable.
STREAM_PORT=3120

# 脚本注入 (Userscript Injection)
ENABLE_SCRIPT_INJECTION=false
USERSCRIPT_PATH=browser_utils/more_models.js

# Camoufox WebSocket 捕获超时 (秒)
ENDPOINT_CAPTURE_TIMEOUT=45

# 模型配置 (Model Metadata)
MODEL_NAME=AI-Studio_Proxy_API
CHAT_COMPLETION_ID_PREFIX=chatcmpl-
AI_STUDIO_URL_PATTERN=aistudio.google.com/

# 排除模型列表文件 (Excluded Models)
EXCLUDED_MODELS_FILENAME=excluded_models.txt

# =============================================================================
# 9. 前端构建配置 (Frontend Build Configuration)
# =============================================================================

# 跳过前端构建检查 (Skip Frontend Build)
SKIP_FRONTEND_BUILD=false
