# AI Studio Proxy API Configuration File Example
# Copy this file to .env and modify the configuration as needed

# =============================================================================
# Service Port Configuration
# =============================================================================

# FastAPI Service Port
PORT=2048

# GUI Launcher Default Port Configuration
DEFAULT_FASTAPI_PORT=2048
DEFAULT_CAMOUFOX_PORT=9222

# Camoufox WebSocket Endpoint Capture Timeout (seconds)
ENDPOINT_CAPTURE_TIMEOUT=45

# Streaming Proxy Service Configuration
STREAM_PORT=3120
# Set to 0 to disable the streaming proxy service

# =============================================================================
# Proxy Configuration
# =============================================================================

# HTTP/HTTPS Proxy Settings
# HTTP_PROXY=http://127.0.0.1:7890
# HTTPS_PROXY=http://127.0.0.1:7890

# Unified Proxy Configuration (Higher priority than HTTP_PROXY/HTTPS_PROXY)
UNIFIED_PROXY_CONFIG=http://127.0.0.1:7890

# Proxy Bypass List (Separated by semicolons)
# NO_PROXY=localhost;127.0.0.1;*.local

# =============================================================================
# Log Configuration
# =============================================================================

# Server Log Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
SERVER_LOG_LEVEL=INFO

# Whether to redirect print output to logs
SERVER_REDIRECT_PRINT=false

# Enable Debug Logs
DEBUG_LOGS_ENABLED=false

# Enable Trace Logs
TRACE_LOGS_ENABLED=false

# =============================================================================
# Authentication Configuration
# =============================================================================

# Auto-save Authentication Information
AUTO_SAVE_AUTH=false

# Auth Save Timeout (seconds)
AUTH_SAVE_TIMEOUT=30

# Auto Confirm Login
# Auto Rotate Auth Profile (true/false)
# When enabled, the system will automatically rotate authentication profiles
# when quota is exceeded or other auth-related issues occur
AUTO_ROTATE_AUTH_PROFILE=true

# Auto Auth Rotation on Startup (true/false)
# When enabled, the system will automatically select an available auth profile
# when starting in headless mode.
AUTO_AUTH_ROTATION_ON_STARTUP=false

AUTO_CONFIRM_LOGIN=true

# Quota Rotation Thresholds (Graceful Rotation)
# Soft Limit: Triggers "Rotation Pending" flag. Current stream finishes, then rotates.
QUOTA_SOFT_LIMIT=450000
# Hard Limit: Triggers immediate "Kill Signal" to prevent hard bans.
QUOTA_HARD_LIMIT=550000

# Only collect attachments from the current user's message (true/false)
ONLY_COLLECT_CURRENT_USER_ATTACHMENTS=false

# =============================================================================
# Browser Configuration
# =============================================================================

# Camoufox WebSocket Endpoint
# CAMOUFOX_WS_ENDPOINT=ws://127.0.0.1:9222

# Launch Mode (normal, headless, virtual_display, direct_debug_no_browser)
LAUNCH_MODE=normal

# =============================================================================
# API Default Parameter Configuration
# =============================================================================

# Default Temperature (0.0-2.0)
DEFAULT_TEMPERATURE=1.0

# Default Max Output Tokens
DEFAULT_MAX_OUTPUT_TOKENS=65536

# Default Top-P Value (0.0-1.0)
DEFAULT_TOP_P=0.95

# Default stop sequences (JSON array format)
DEFAULT_STOP_SEQUENCES=["User:"]

# Whether to automatically open and use the "URL Context" feature when processing requests.
# For details on this tool, refer to: https://ai.google.dev/gemini-api/docs/url-context
ENABLE_URL_CONTEXT=false

# Whether to enable the "Thinking Budget" feature by default (true/false).
# When disabled, the model will generally decide the thinking budget itself.
# This value is used when the reasoning_effort parameter is not provided in the API request.
ENABLE_THINKING_BUDGET=false

# Default value for "Thinking Budget" (tokens)
# Thinking Budget Level Values (tokens) - Used for "low", "medium", "high" presets
# These values override the hardcoded defaults when set via environment variables
THINKING_BUDGET_LOW=8000
THINKING_BUDGET_MEDIUM=16000
THINKING_BUDGET_HIGH=32000
# This value is used when the reasoning_effort parameter is not provided in the API request.
DEFAULT_THINKING_BUDGET=8192

# Control whether disabling streaming automatically disables the thinking budget (current behavior).
# Set to 'false' to allow the thinking budget toggle to remain independent of streaming status.
DISABLE_THINKING_BUDGET_ON_STREAMING_DISABLE=false

# Whether to enable the "Google Search" feature by default (true/false)
# When the tools parameter is not provided in the API request, this setting is used as the default toggle state for Google Search.
ENABLE_GOOGLE_SEARCH=false

# =============================================================================
# Timeout Configuration (milliseconds)
# =============================================================================

# Response Completion Total Timeout (milliseconds)
# This is the BASE timeout for AI response generation. The actual timeout used
# is dynamically calculated as: max(5s + prompt_length/1000, RESPONSE_COMPLETION_TIMEOUT/1000)
# This ensures larger prompts get proportionally longer timeouts while respecting
# the configured minimum. Default: 600000ms (10 minutes).
#
# IMPORTANT: The dynamic silence threshold is automatically calculated as:
# max(60s, dynamic_timeout / 2.0) to allow "thinking" models time to generate
# internal reasoning without triggering premature timeouts.
#
# Examples:
# - 300000 (5 min) - Shorter timeout for quick responses
# - 600000 (10 min) - Recommended for most use cases
# - 900000 (15 min) - For very large prompts or deep reasoning tasks
RESPONSE_COMPLETION_TIMEOUT=600000

# Initial Wait Time Before Polling
INITIAL_WAIT_MS_BEFORE_POLLING=500

# Polling Interval
POLLING_INTERVAL=300
POLLING_INTERVAL_STREAM=180

# Silence Timeout (milliseconds)
# Base silence detection threshold. The actual silence threshold is dynamically
# scaled based on the request timeout: max(SILENCE_TIMEOUT_MS/1000, dynamic_timeout/2.0)
# This prevents premature disconnects when "thinking" models pause during reasoning.
# Default: 60000ms (60 seconds).
SILENCE_TIMEOUT_MS=60000

# Page Action Timeouts
POST_SPINNER_CHECK_DELAY_MS=500
FINAL_STATE_CHECK_TIMEOUT_MS=1500
POST_COMPLETION_BUFFER=700

# UI Generation Wait Configuration (milliseconds)
UI_GENERATION_WAIT_TIMEOUT_MS=5000
UI_GENERATION_CHECK_INTERVAL_MS=500
UI_STABILIZATION_BUFFER_MS=500

# Clear Chat Related Timeouts
CLEAR_CHAT_VERIFY_TIMEOUT_MS=4000
CLEAR_CHAT_VERIFY_INTERVAL_MS=4000

# Click and Clipboard Action Timeouts
CLICK_TIMEOUT_MS=3000
CLIPBOARD_READ_TIMEOUT_MS=3000

# Element Wait Timeout
WAIT_FOR_ELEMENT_TIMEOUT_MS=10000

# Stream Related Configuration
PSEUDO_STREAM_DELAY=0.01

# =============================================================================
# GUI Launcher Configuration
# =============================================================================

# GUI Default Proxy Address
GUI_DEFAULT_PROXY_ADDRESS=http://127.0.0.1:7890

# GUI Default Streaming Proxy Port
GUI_DEFAULT_STREAM_PORT=3120

# GUI Default Helper Endpoint
GUI_DEFAULT_HELPER_ENDPOINT=

# =============================================================================
# Script Injection Configuration
# =============================================================================

# Whether to enable Tampermonkey script injection (Deprecated/No longer effective)
ENABLE_SCRIPT_INJECTION=false

# Tampermonkey script file path (relative to project root)
# Model data is parsed directly from this script file, no extra config file needed
USERSCRIPT_PATH=browser_utils/more_modles.js

# =============================================================================
# Other Configuration
# =============================================================================

# Model Name
MODEL_NAME=AI-Studio_Proxy_API

# Chat Completion ID Prefix
CHAT_COMPLETION_ID_PREFIX=chatcmpl-

# Default Fallback Model ID
DEFAULT_FALLBACK_MODEL_ID=no model list

# Excluded Models Filename
EXCLUDED_MODELS_FILENAME=excluded_models.txt

# AI Studio URL Pattern
AI_STUDIO_URL_PATTERN=aistudio.google.com/

# Model Endpoint URL Contains String
MODELS_ENDPOINT_URL_CONTAINS=MakerSuiteService/ListModels

# User Input Markers
USER_INPUT_START_MARKER_SERVER=__USER_INPUT_START__
USER_INPUT_END_MARKER_SERVER=__USER_INPUT_END__

# =============================================================================
# Stream State Configuration
# =============================================================================

# Stream Timeout Log State Configuration
STREAM_MAX_INITIAL_ERRORS=3
STREAM_WARNING_INTERVAL_AFTER_SUPPRESS=60.0
STREAM_SUPPRESS_DURATION_AFTER_INITIAL_BURST=400.0